## Check-list работоспособности сервиса wb-device-manager

### Общие требования
* пакет собирается на Jenkins; unit-тесты **запускаются** и отрабатывают корректно
* пакет успешно устанавливается на WB с релизом > wb-2207; **не** устанавливается на <= wb-2207
* systemd-сервис wb-device-manager запущен после установки пакета; запущен после перезагрузки WB
* journalctl -u wb-device-manager -f не выдаёт debug-сообщения
* systemd-сервис wb-device-manager не пытается перезапускаться при отсутствии соединения с mosquitto
* при остановке mosquitto, сервис wb-device-manager остаётся running; перезапуск сервиса приводит к failed
* корректные exit-codes (остановить systemd-сервис; запускать утилиту вручную):
    * 2 - на запуск с недопустимыми ключами
    * 4 - на запуск при остановленном mosquitto
* при запуске вручную, нормально останавливается по Ctrl+C; без зависаний и ругательств
* на пропажу связи с mosquitto - ругается ворнингами
* после пропажи и последующего восстановления соединения с mosquitto - работает **без необходимости перезапуска**

### Интерфейс rpc наружу
* rpc-запрос к wb-device-manager с неправильными параметрами возвращает ошибку (32700)
* быстрый повторный rpc-запрос к wb-device-manager с неизменными параметрами возвращает ошибку (33100)
    * #### сканирование портов (*/bus-scan/Scan):
        * первая публикация state после начала сканирования возвращает изначальное состояние (нет устройств с предыдущего сканирования)
        * периодически публикует json всего состояния в /wb-device-manager/state
        * не блокирует другие rpc-вызовы к wb-device-manager
        * в json-e state'a - адекватная информация (особенно - вокруг настроек связи)
        * при остановке сервиса - чистит топики
